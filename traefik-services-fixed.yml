http:
  routers:
    # Dokploy Dashboard
    dokploy:
      rule: "Host(`dk8.bizoholic.net`)"
      service: dokploy
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # Admin Dashboard
    admin-dashboard:
      rule: "Host(`admin.bizoholic.net`)"
      service: admin-dashboard
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # Client Portal
    client-portal:
      rule: "Host(`app.bizoholic.net`)"
      service: client-portal
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # Brain API
    brain-api:
      rule: "Host(`api.bizoholic.net`)"
      service: brain-api
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # Authentik SSO
    authentik:
      rule: "Host(`sso.bizoholic.net`)"
      service: authentik
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # Plane Project Management
    plane:
      rule: "Host(`plane.bizoholic.net`)"
      service: plane
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # Lago Billing
    lago:
      rule: "Host(`billing.bizoholic.net`)"
      service: lago
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
    
    # HTTP to HTTPS redirect
    http-catchall:
      rule: "HostRegexp(`{host:.+}`)"
      entryPoints:
        - web
      middlewares:
        - redirect-to-https
      service: noop@internal

  services:
    # Dokploy Dashboard - Port 3000
    dokploy:
      loadBalancer:
        servers:
          - url: "http://dokploy.1.dtv0ch91g2jo9f4rdp0qbiyj1:3000"
    
    # Admin Dashboard - Port 3000
    admin-dashboard:
      loadBalancer:
        servers:
          - url: "http://bizosaas-admin-dashboard-staging:3000"
    
    # Client Portal - Port 3000
    client-portal:
      loadBalancer:
        servers:
          - url: "http://client-portal:3000"
    
    # Brain API - Port 8000
    brain-api:
      loadBalancer:
        servers:
          - url: "http://bizosaas-brain-staging:8000"
    
    # Authentik SSO - Port 9000 (FIXED)
    authentik:
      loadBalancer:
        servers:
          - url: "http://bizosaas-authentik-server:9000"
    
    # Plane - Port 80
    plane:
      loadBalancer:
        servers:
          - url: "http://bizosaasinfra-bizosaasplane-s8bv6u-plane-web-1:80"
    
    # Lago - Port 80 (ADDED)
    lago:
      loadBalancer:
        servers:
          - url: "http://lago-front:80"

  middlewares:
    redirect-to-https:
      redirectScheme:
        scheme: https
        permanent: true
